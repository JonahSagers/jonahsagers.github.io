<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Floating Bubble</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    html, body {
      height: 100%;
      margin: 0;
      overflow: hidden;
      background: #f0f8ff;
    }
    .bubble {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translate(-50%, 0);
    }
  </style>
</head>
<body>

  <div class="bubble bg-primary text-white rounded-circle d-flex justify-content-center align-items-center"
      style="width: 150px; height: 150px; --xPos: 0.15; --yPos: 0.3;">
    <div class="inner-circle bg-white rounded-circle" style="width: 125px; height: 125px;"></div>
  </div>
  <div class="bubble bg-primary text-white rounded-circle d-flex justify-content-center align-items-center"
      style="width: 150px; height: 150px; --xPos: 0.25; --yPos: 0.7;">
    <div class="inner-circle bg-white rounded-circle" style="width: 125px; height: 125px;"></div>
  </div>
  <div class="bubble bg-primary text-white rounded-circle d-flex justify-content-center align-items-center"
      style="width: 150px; height: 150px; --xPos: 0.75; --yPos: 0.3;">
    <div class="inner-circle bg-white rounded-circle" style="width: 125px; height: 125px;"></div>
  </div>
  <div class="bubble bg-primary text-white rounded-circle d-flex justify-content-center align-items-center"
      style="width: 150px; height: 150px; --xPos: 0.8; --yPos: 0.75;">
    <div class="inner-circle bg-white rounded-circle" style="width: 125px; height: 125px;"></div>
  </div>

  <script>
    // Simple Perlin noise generator
    class Perlin {
      constructor() {
        this.grad = [];
        for (let i = 0; i < 256; i++) {
          this.grad[i] = Math.random() * 2 - 1;
        }
      }

      fade(t) {
        return t * t * t * (t * (t * 6 - 15) + 10);
      }

      lerp(a, b, t) {
        return a + t * (b - a);
      }

      noise(x) {
        let xi = Math.floor(x) & 255;
        let xf = x - Math.floor(x);
        let g1 = this.grad[xi];
        let g2 = this.grad[(xi + 1) & 255];
        let dot1 = g1 * xf;
        let dot2 = g2 * (xf - 1);
        let u = this.fade(xf);
        return this.lerp(dot1, dot2, u);
      }
    }

    const perlin = new Perlin();
    const bubbles = document.getElementsByClassName('bubble');
    const xPercent = 0.7;
    const yPercent = 0.9;

    for (const bubble of bubbles){
        // bubble.xPos = (window.innerHeight * (Math.random() * yPercent)); 
        // bubble.yPos = (window.innerWidth/2 * (Math.random() * xPercent * 2 - xPercent));
        bubble.t = Math.random() * 100;
        bubble.ySpeed = 0.2 + Math.random() * 0.2;
        bubble.xPos = (parseFloat(bubble.style.getPropertyValue("--xPos")) - 0.5) * window.innerWidth - perlin.noise(bubble.t) * 500;
        bubble.yPos = parseFloat(bubble.style.getPropertyValue("--yPos")) * window.innerHeight;
        bubble.height = parseFloat(bubble.style.getPropertyValue("height"));
        bubble.size = 1;
        console.log(bubble.height);
        

    }

    function animate() {
      for (const bubble of bubbles) {
        if (bubble.matches(':hover')){
            bubble.style.setProperty("z-index", 10);
            mult = 3.5;
        } else {
          bubble.style.setProperty("z-index", 1);
            mult = 1;
        }
        bubble.xNoise = bubble.xPos + perlin.noise(bubble.t) * 200;

        bubble.yPos -= bubble.ySpeed / mult; // upward speed

        // Reset if the bubble floats off the top
        if (bubble.yPos < -bubble.height) {
            bubble.yPos = window.innerHeight;
        }

        bubble.size += (mult  - bubble.size) / 7;

        bubble.style.transform = `translate(calc(-50% + ${bubble.xNoise}px), ${bubble.yPos}px) scale(${bubble.size})`;

        // bubble.style.setProperty("--xPos", bubble.xNoise);
        // bubble.style.setProperty("--yPos", bubble.yPos);

        

        bubble.t += 0.001 / mult;
      }
      requestAnimationFrame(animate);
    }

    animate();
  </script>

</body>
</html>
